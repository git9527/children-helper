name: deploy to aliyun oss

on: [push]

jobs:
  build:

   runs-on: ubuntu-latest

   steps:
     - uses: actions/checkout@v2
     # 使用 node:10
     - name: use Node.js 10.x
       uses: actions/setup-node@v1
       with:
         node-version: 10.x
     # npm install
     - name: build and deploy
       run: |
         npm install
         npm run build
     - name: setup aliyun oss
       uses: manyuanrong/setup-ossutil@master
       with:
         endpoint: oss-cn-beijing.aliyuncs.com
         access-key-id: ${{ secrets.OSS_KEY_ID }}
         access-key-secret: ${{ secrets.OSS_KEY_SECRET }}
     - name: copy file to oss
       run: ossutil cp -rf ./dist/* oss://${{OSS_KEY_BUCKET}}/
